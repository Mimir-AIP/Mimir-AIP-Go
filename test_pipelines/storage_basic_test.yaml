name: "Storage Basic Operations Test"
description: "Test basic storage operations: store, query, delete"

steps:
  - name: "Create Test Collection"
    plugin: "Storage.vector"
    config:
      operation: "create_collection"
      name: "test_collection"
    output: "collection_result"

  - name: "Store Sample Documents"
    plugin: "Storage.vector"
    config:
      operation: "store"
      collection: "test_collection"
      documents:
        - id: "doc1"
          content: "The sky is blue because of Rayleigh scattering"
          metadata:
            source: "science"
            topic: "physics"
            type: "explanation"
        - id: "doc2"
          content: "Photosynthesis is the process by which plants make food using sunlight"
          metadata:
            source: "biology"
            topic: "plants"
            type: "process"
        - id: "doc3"
          content: "Machine learning is a subset of artificial intelligence"
          metadata:
            source: "technology"
            topic: "AI"
            type: "definition"
    output: "store_result"

  - name: "Query Similar Documents"
    plugin: "Storage.vector"
    config:
      operation: "query"
      collection: "test_collection"
      query: "How do plants make food?"
      limit: 2
    output: "query_result"

  - name: "Get Specific Document"
    plugin: "Storage.vector"
    config:
      operation: "get"
      collection: "test_collection"
      id: "doc2"
    output: "document"

  - name: "List Collections"
    plugin: "Storage.vector"
    config:
      operation: "list_collections"
    output: "collections"

  - name: "Delete Document"
    plugin: "Storage.vector"
    config:
      operation: "delete"
      collection: "test_collection"
      ids: ["doc3"]
    output: "delete_result"

expected_results:
  store_result:
    operation: "store"
    collection: "test_collection"
    count: 3
    successful: true

  query_result:
    operation: "query"
    collection: "test_collection"
    query: "How do plants make food?"
    limit: 2
    count: 1  # Should find doc2

  document:
    id: "doc2"
    content: "Photosynthesis is the process by which plants make food using sunlight"
    metadata:
      source: "biology"
      topic: "plants"
      type: "process"

  collections:
    - "test_collection"

  delete_result:
    operation: "delete"
    collection: "test_collection"
    count: 1
    successful: true